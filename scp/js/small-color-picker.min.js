/*! SmallColorPicker v1.0.0  | (c) 2013 Antelle | https://github.com/antelle/small-color-picker/blob/master/MIT-LICENSE.txt */
(function(t,o,e,r){"use strict";e.SmallColorPicker=e.SmallColorPicker||{},SmallColorPicker.defaults={placement:{position:"absolute",top:"0",left:"0",parent:null,popup:!1},colors:{colorOld:null,colorNew:"#ff0000"},texts:{ok:"OK",cancel:"Cancel"},behavior:{hideOnSelect:!0},events:{ok:null,cancel:null}},SmallColorPicker.CirclePicker=function(l){function a(){s(),i(),h(),p(),u()}function s(){X={redrawBug:-1!=navigator.userAgent.indexOf("Safari"),borderRadius:"borderRadius"in o.body.style}}function i(){if(!X.borderRadius)throw"Browser is not supported"}function n(){if(j.placement.popup&&z){Y&&(clearTimeout(Y),Y=null);var o=z.position(),r=z.outerWidth(),l=z.outerHeight(),a=t(e).outerHeight(),s=t(e).width(),i=L.el.outerWidth(),n=L.el.outerHeight(),h=10,u=1,p=1,f=15,d={},m={},v={},C=o.top-t(e).scrollTop(),w=a-l-C,g=o.left-t(e).scrollLeft(),k=s-r-g;Math.max(C,w)>n+h&&Math.min(g,k)>i/2-r/2+h?(d.left=o.left+r/2-i/2,m.left=i/2-f,v.left=-f,C>w?(d.top=o.top-n-f+3,m.top=n-2,v.top=-f-u,c("top",f)):(d.top=o.top+l+p+f,m.top=-f,v.top=u,c("bottom",f))):(d.top=o.top+l/2-n/2,m.top=n/2-f,v.top=-f,g>k?(d.left=o.left-i-f+2,m.left=i-1,v.left=-f-u,c("left",f)):(d.left=o.left+r+p+f,m.left=-f,v.left=u,c("right",f))),L.el.css(d),L.arrow.css(m),L.arrowInner.css(v)}}function c(o,e){var r,l=L.arrow.css("color"),a=L.arrowInner.css("color");switch(o){case"top":r="bottom";break;case"bottom":r="top";break;case"left":r="right";break;case"right":r="left"}t.each(["top","right","bottom","left"],function(t,s){var i="border-"+s,n=s==o?l:"transparent",c=s==r?"none":e+"px solid "+n;L.arrow.css(i,c),n=s==o?a:"transparent",c=s==r?"none":e+"px solid "+n,L.arrowInner.css(i,c)})}function h(){L={},L.el=t("<div></div>").appendTo(j.placement.popup||!z?o.body:z).addClass("s-c-p").css({position:j.placement.position,left:j.placement.left,top:j.placement.top}),"static"==L.el.css("position")&&L.el.css("position","relative"),j.placement.popup&&(L.el.css("position","absolute"),L.el.addClass("s-c-p-popup"),L.arrow=t("<div></div>").appendTo(L.el).addClass("s-c-p-arrow"),L.arrowInner=t("<div></div>").appendTo(L.arrow).addClass("s-c-p-arrow-inner")),L.circle=t("<div></div>").appendTo(L.el).addClass("s-c-p-circle"),L.innerCircle=t("<div></div>").appendTo(L.circle).addClass("s-c-p-circle-inner"),L.circleMark=t("<div></div>").appendTo(L.circle).addClass("s-c-p-circle-mark"),L.square=t("<canvas></canvas>").appendTo(L.el).addClass("s-c-p-square"),L.squareMark=t("<div></div>").appendTo(L.el).addClass("s-c-p-square-mark"),L.square.attr({width:L.square.width(),height:L.square.height()}),L.colorOld=t("<div></div>").appendTo(L.el).addClass("s-c-p-color s-c-p-color-old"),L.colorNew=t("<div></div>").appendTo(L.el).addClass("s-c-p-color s-c-p-color-new"),L.sampleOld=t("<div></div>").appendTo(L.el).addClass("s-c-p-sample s-c-p-sample-old").text(j.texts.cancel),L.sampleNew=t("<div></div>").appendTo(L.el).addClass("s-c-p-sample s-c-p-sample-new").text(j.texts.ok)}function u(){N={globalSelectionMode:t(o.body).css("user-select"),squareWidth:L.square.width(),circleWidth:L.circle.width(),elWidth:L.el.width()}}function p(){L.circle.on("mousedown",f),L.square.on("mousedown",d).on("selectstart",function(t){t.preventDefault()}),L.sampleNew.click(function(){j.behavior.hideOnSelect&&(O(),A=Q),j.events.ok&&j.events.ok(Q.toHex())}),L.sampleOld.click(function(){j.behavior.hideOnSelect&&O(),j.events.cancel&&j.events.cancel(A.toHex())}),j.placement.popup&&z&&t(e).resize(w)}function f(e){e.preventDefault(),g(e.pageX,e.pageY),S(!1),t(o).on("mousemove",m).one("mouseup",C)}function d(e){e.preventDefault(),k(e.pageX,e.pageY),S(!1),t(o).on("mousemove",v).one("mouseup",C)}function m(t){g(t.pageX,t.pageY)}function v(t){k(t.pageX,t.pageY)}function C(){S(!0),t(o).off("mousemove",m).off("mousemove",v)}function w(){W()&&j.placement.popup&&!Y&&(Y=setTimeout(n,100))}function g(t,o){var e=L.circle.offset(),r=T(t-e.left,o-e.top);Q.hue(r);var l=(new SmallColorPicker.Color).setHsv(r,100,100);y(l.toHex()),M(),D(r),H()}function k(t,o){if(!U.fw){var e=L.circle.offset(),r=N.circleWidth/2,l=N.squareWidth/2;U.fw=new SmallColorPicker.Transforms.Translate2D(-e.left-r,-e.top-r).chain(new SmallColorPicker.Transforms.Rotate2D(-K)).chain(new SmallColorPicker.Transforms.Translate2D(l,l))}var a=U.fw.apply([t,o]);t=Math.max(0,Math.min(N.squareWidth-1,a[0])),o=Math.max(0,Math.min(N.squareWidth-1,a[1])),Q=b(t,o),M(),H(t,o)}function S(e){t(o.body).css({webkitUserSelect:e?N.globalSelectionMode:"none"})}function T(t,o){var e=N.circleWidth;t-=e/2,o-=e/2;var r=Math.atan2(t,o);return 180-360*(r/Math.PI/2)}function b(t,o){var e=L.square[0],r=e.getContext("2d"),l=r.getImageData(t,o,1,1).data;return(new SmallColorPicker.Color).setRgb(l[0],l[1],l[2])}function P(){L.colorOld[0].innerHTML=null===A?"":A.toHex(),x(L.sampleOld,null===A?new SmallColorPicker.Color(10066329):A,"old")}function M(){L.colorNew[0].innerHTML=Q.toHex(),x(L.sampleNew,Q,"new")}function x(t,o,e){var r=o.toHsv().v;t[0].style.backgroundColor=o.toHex(),N.colorSamplesLight||(N.colorSamplesLight={}),r>80?N.colorSamplesLight[e]!==!0&&(N.colorSamplesLight[e]=!0,t.addClass("s-c-p-light")):N.colorSamplesLight[e]!==!1&&(N.colorSamplesLight[e]=!1,t.removeClass("s-c-p-light"))}function y(t){var o=new SmallColorPicker.Color(t),e=o.hue(),r=L.square[0],l=r.width,a=r.getContext("2d");a.clearRect(0,0,l,l);for(var s=a.createImageData(l,l),i=s.data,n=0;l>n;n++)for(var c=0;l>c;c++){o.setHsv(e,Math.round(100*n/(l-1)),Math.round(100*c/(l-1)));var h=4*((l-c-1)*l+n);i[h]=o.r(),i[h+1]=o.g(),i[h+2]=o.b(),i[h+3]=255}a.putImageData(s,0,0)}function D(t){var o=t===r?Q.hue():t,e=o/180*Math.PI,l=N.circleWidth,a=.025,s={transform:"rotate("+e+"rad)",left:l/2-l*Math.sin(-e+a)/2,top:l/2-l*Math.cos(-e+a)/2};L.circleMark.css(s),K=e-Math.PI/4,U={},L.square.css({transform:"rotate("+K+"rad)"})}function H(t,o){var e=N.squareWidth,l=Q.toHsv(),a=0,s=0;if(t!==r&&(B=t),o!==r&&(V=o),B!==r&&V!==r?(a+=B,s+=V):(a+=~~(l.s*e/100),s+=e-~~(l.v*e/100),a=Math.max(0,Math.min(e-1,a)),s=Math.max(0,Math.min(e-1,s))),!U.rev){var i=N.squareWidth/2,n=N.elWidth/2;U.rev=new SmallColorPicker.Transforms.Translate2D(-i,-i).chain(new SmallColorPicker.Transforms.Rotate2D(K)).chain(new SmallColorPicker.Transforms.Translate2D(n-3,n-3))}var c=U.rev.apply([a,s]),h=L.squareMark[0].style;h.left=c[0]+"px",h.top=c[1]+"px",q()}function q(){var t=Q.getPerceivedBrightness()>125;if(N.isSqMaskLight!==t){N.isSqMaskLight=t;var o=(new SmallColorPicker.Color).setHsv(0,0,t?40:90);L.squareMark[0].style.borderColor=o.toHex(),I(L.squareMark[0])}}function I(t){X.redrawBug&&(t.style.display="inline-block",t.offsetHeight,t.style.display="block")}function R(){D(),H()}function W(){return L&&L.el&&L.el.is(":visible")}function O(){L.el.hide()}var L,N,B,V,X,Y,j=t.extend(!0,{},SmallColorPicker.defaults,l),Q=new SmallColorPicker.Color(j.colors.colorNew),A=new SmallColorPicker.Color(j.colors.colorOld),z=j.placement.parent?t(j.placement.parent):null,K=0,U={};this.toggle=function(){this.isVisible()?this.hide():this.show()},this.show=function(){L||a(),y(Q.toHex()),P(),M(),R(),L.el.show(),n(),u()},this.isVisible=W,this.hide=O,this.setColors=function(t,o){t!==r&&(Q=new SmallColorPicker.Color(t)),o!==r&&(A=null===o?null:new SmallColorPicker.Color(o)),this.isVisible()&&this.show()},this.parent=function(o){return o&&(this.isVisible()?(this.hide(),z=t(o),this.show()):z=t(o)),z}}})(window.jQuery,document,window),function(t,o,e,r){"use strict";e.SmallColorPicker=e.SmallColorPicker||{},SmallColorPicker.Color=function(t){if(this.val=0,"number"==typeof t)this.val=t;else if("string"==typeof t)if("#"===t.charAt(0))this.val=parseInt(t.substr(1),16);else{var o=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/g.exec(t);if(!o)throw"Invalid color: "+t;this.setRgb(parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}},SmallColorPicker.Color.prototype={constructor:SmallColorPicker.Color,r:function(t){return t!==r?(this.val=65535&this.val|t<<16,t):255&this.val>>16},g:function(t){return t!==r?(this.val=16711935&this.val|t<<8,t):255&this.val>>8},b:function(t){return t!==r?(this.val=16776960&this.val|t,t):255&this.val},toHex:function(){var t=("00000"+this.val.toString(16)).substr(-6);return"#"+t},toRgb:function(){return{r:this.r(),g:this.g(),b:this.b()}},toRgbStr:function(){return"rgb("+this.r()+","+this.g()+","+this.b()+")"},setRgb:function(t,o,e){return this.r(t),this.g(o),this.b(e),this},toHsv:function(){var t,o,e,r=this.r(),l=this.g(),a=this.b(),s=Math.min(r,l,a),i=Math.max(r,l,a),n=i-s;if(e=Math.floor(100*(i/255)),0==i)return{h:0,s:0,v:0};o=Math.floor(100*(n/i));var c=0==n?1:n;return t=r==i?(l-a)/c:l==i?2+(a-r)/c:4+(r-l)/c,t=Math.floor(60*t),0>t&&(t+=360),{h:t,s:o,v:e}},setHsv:function(t,o,e){if(t/=360,o/=100,e/=100,0==o){var r=Math.round(255*e);return this.r(r),this.g(r),this.b(r),this}var l,a,s,i=6*t,n=Math.floor(i),c=e*(1-o),h=e*(1-o*(i-n)),u=e*(1-o*(1-(i-n)));return 0==n?(l=e,a=u,s=c):1==n?(l=h,a=e,s=c):2==n?(l=c,a=e,s=u):3==n?(l=c,a=h,s=e):4==n?(l=u,a=c,s=e):(l=e,a=c,s=h),this.r(Math.round(255*l)),this.g(Math.round(255*a)),this.b(Math.round(255*s)),this},hue:function(t){if(t!==r){var o=this.toHsv();return this.setHsv(t,o.s,o.v),this}return this.toHsv().h},getPerceivedBrightness:function(){var t=this.toRgb();return Math.sqrt(.241*t.r*t.r+.691*t.g*t.g+.068*t.b*t.b)}}}(window.jQuery,document,window),function(t,o,e){"use strict";e.SmallColorPicker=e.SmallColorPicker||{},SmallColorPicker.Transforms={},SmallColorPicker.Transforms.Transform2D=function(t){this.matrix=t,this.next=null},SmallColorPicker.Transforms.Transform2D.prototype={constructor:SmallColorPicker.Transforms.Transform2D,apply:function(t){var o=[this.matrix[0][0]*t[0]+this.matrix[0][1]*t[1]+this.matrix[0][2],this.matrix[1][0]*t[0]+this.matrix[1][1]*t[1]+this.matrix[1][2]];return this.next?this.next.apply(o):o},chain:function(t){return this.next?this.next.chain(t):this.next=t,this}},SmallColorPicker.Transforms.Translate2D=function(t,o){SmallColorPicker.Transforms.Transform2D.call(this,[[1,0,t],[0,1,o]])},SmallColorPicker.Transforms.Translate2D.prototype=new SmallColorPicker.Transforms.Transform2D,SmallColorPicker.Transforms.Translate2D.prototype.constructor=SmallColorPicker.Transforms.Translate2D,SmallColorPicker.Transforms.Rotate2D=function(t){var o=Math.cos(t),e=Math.sin(t);SmallColorPicker.Transforms.Transform2D.call(this,[[o,-e,0],[e,o,0]])},SmallColorPicker.Transforms.Rotate2D.prototype=new SmallColorPicker.Transforms.Transform2D,SmallColorPicker.Transforms.Rotate2D.prototype.constructor=SmallColorPicker.Transforms.Translate2D}(window.jQuery,document,window);