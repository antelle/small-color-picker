/*! SmallColorPicker v1.0.1  | (c) 2013 Antelle | https://github.com/antelle/small-color-picker/blob/master/MIT-LICENSE.txt */
(function(t,e,o,r){"use strict";o.SmallColorPicker=o.SmallColorPicker||{},SmallColorPicker.defaults={placement:{position:"absolute",top:"0",left:"0",parent:null,popup:!1},colors:{colorOld:null,colorNew:"#ff0000"},texts:{ok:"OK",cancel:"Cancel"},behavior:{rotate:!0,hideOnSelect:!0},events:{ok:null,cancel:null}},SmallColorPicker.CirclePicker=function(a){function l(){s(),i(),h(),u(),p()}function s(){Y={redrawBug:-1!=navigator.userAgent.indexOf("Safari"),directCanvasRotate:-1==navigator.userAgent.indexOf("Firefox"),borderRadius:"borderRadius"in e.body.style}}function i(){if(!Y.borderRadius)throw"Browser is not supported"}function n(){if(A.placement.popup&&z){j&&(clearTimeout(j),j=null);var e=z.position(),r=z.outerWidth(),a=z.outerHeight(),l=t(o).outerHeight(),s=t(o).width(),i=L.el.outerWidth(),n=L.el.outerHeight(),h=10,p=1,u=1,d=15,f={},m={},v={},C=e.top-t(o).scrollTop(),w=l-a-C,g=e.left-t(o).scrollLeft(),k=s-r-g;Math.max(C,w)>n+h&&Math.min(g,k)>i/2-r/2+h?(f.left=e.left+r/2-i/2,m.left=i/2-d,v.left=-d,C>w?(f.top=e.top-n-d+3,m.top=n-2,v.top=-d-p,c("top",d)):(f.top=e.top+a+u+d,m.top=-d,v.top=p,c("bottom",d))):(f.top=e.top+a/2-n/2,m.top=n/2-d,v.top=-d,g>k?(f.left=e.left-i-d+2,m.left=i-1,v.left=-d-p,c("left",d)):(f.left=e.left+r+u+d,m.left=-d,v.left=p,c("right",d))),L.el.css(f),L.arrow.css(m),L.arrowInner.css(v)}}function c(e,o){var r,a=L.arrow.css("color"),l=L.arrowInner.css("color");switch(e){case"top":r="bottom";break;case"bottom":r="top";break;case"left":r="right";break;case"right":r="left"}t.each(["top","right","bottom","left"],function(t,s){var i="border-"+s,n=s==e?a:"transparent",c=s==r?"none":o+"px solid "+n;L.arrow.css(i,c),n=s==e?l:"transparent",c=s==r?"none":o+"px solid "+n,L.arrowInner.css(i,c)})}function h(){L={},L.el=t("<div></div>").appendTo(A.placement.popup||!z?e.body:z).addClass("s-c-p").css({position:A.placement.position,left:A.placement.left,top:A.placement.top}),"static"==L.el.css("position")&&L.el.css("position","relative"),A.placement.popup&&(L.el.css("position","absolute"),L.el.addClass("s-c-p-popup"),L.arrow=t("<div></div>").appendTo(L.el).addClass("s-c-p-arrow"),L.arrowInner=t("<div></div>").appendTo(L.arrow).addClass("s-c-p-arrow-inner")),L.circle=t("<div></div>").appendTo(L.el).addClass("s-c-p-circle"),L.innerCircle=t("<div></div>").appendTo(L.circle).addClass("s-c-p-circle-inner"),L.circleMark=t("<div></div>").appendTo(L.circle).addClass("s-c-p-circle-mark"),L.square=t(Y.directCanvasRotate?"<canvas></canvas>":"<img></img>").appendTo(L.el).addClass("s-c-p-square"),L.squareMark=t("<div></div>").appendTo(L.el).addClass("s-c-p-square-mark"),L.colorOld=t("<div></div>").appendTo(L.el).addClass("s-c-p-color s-c-p-color-old"),L.colorNew=t("<div></div>").appendTo(L.el).addClass("s-c-p-color s-c-p-color-new"),L.sampleOld=t("<div></div>").appendTo(L.el).addClass("s-c-p-sample s-c-p-sample-old").text(A.texts.cancel),L.sampleNew=t("<div></div>").appendTo(L.el).addClass("s-c-p-sample s-c-p-sample-new").text(A.texts.ok),B=Y.directCanvasRotate?L.square[0]:t("<canvas></canvas>").appendTo(L.el).hide()[0],t(B).attr({width:L.square.width(),height:L.square.height()})}function p(){N={globalSelectionMode:t(e.body).css("user-select"),squareWidth:L.square.width(),circleWidth:L.circle.width(),elWidth:L.el.width()}}function u(){L.circle.on("mousedown",d),L.square.on("mousedown",f).on("selectstart",function(t){t.preventDefault()}),L.sampleNew.click(function(){A.behavior.hideOnSelect&&(O(),U=Q),A.events.ok&&A.events.ok(Q.toHex())}),L.sampleOld.click(function(){A.behavior.hideOnSelect&&O(),A.events.cancel&&A.events.cancel(U.toHex())}),A.placement.popup&&z&&t(o).resize(w)}function d(o){o.preventDefault(),g(o.pageX,o.pageY),S(!1),t(e).on("mousemove",m).one("mouseup",C)}function f(o){o.preventDefault(),k(o.pageX,o.pageY),S(!1),t(e).on("mousemove",v).one("mouseup",C)}function m(t){g(t.pageX,t.pageY)}function v(t){k(t.pageX,t.pageY)}function C(){S(!0),t(e).off("mousemove",m).off("mousemove",v)}function w(){W()&&A.placement.popup&&!j&&(j=setTimeout(n,100))}function g(t,e){var o=L.circle.offset(),r=b(t-o.left,e-o.top);Q.hue(r);var a=(new SmallColorPicker.Color).setHsv(r,100,100);D(a.toHex()),x(),y(r),H()}function k(t,e){if(!K.fw){var o=L.circle.offset(),r=N.circleWidth/2,a=N.squareWidth/2;K.fw=new SmallColorPicker.Transforms.Translate2D(-o.left-r,-o.top-r),A.behavior.rotate&&K.fw.chain(new SmallColorPicker.Transforms.Rotate2D(-F)),K.fw.chain(new SmallColorPicker.Transforms.Translate2D(a,a))}var l=K.fw.apply([t,e]);t=Math.max(0,Math.min(N.squareWidth-1,l[0])),e=Math.max(0,Math.min(N.squareWidth-1,l[1])),Q=T(t,e),x(),H(t,e)}function S(o){t(e.body).css({webkitUserSelect:o?N.globalSelectionMode:"none"})}function b(t,e){var o=N.circleWidth;t-=o/2,e-=o/2;var r=Math.atan2(t,e);return 180-360*(r/Math.PI/2)}function T(t,e){var o=B.getContext("2d"),r=o.getImageData(t,e,1,1).data;return(new SmallColorPicker.Color).setRgb(r[0],r[1],r[2])}function P(){L.colorOld[0].innerHTML=null===U?"":U.toHex(),M(L.sampleOld,null===U?new SmallColorPicker.Color(10066329):U,"old")}function x(){L.colorNew[0].innerHTML=Q.toHex(),M(L.sampleNew,Q,"new")}function M(t,e,o){var r=e.toHsv().v;t[0].style.backgroundColor=e.toHex(),N.colorSamplesLight||(N.colorSamplesLight={}),r>80?N.colorSamplesLight[o]!==!0&&(N.colorSamplesLight[o]=!0,t.addClass("s-c-p-light")):N.colorSamplesLight[o]!==!1&&(N.colorSamplesLight[o]=!1,t.removeClass("s-c-p-light"))}function D(t){var e=new SmallColorPicker.Color(t),o=e.hue(),r=B.width,a=B.getContext("2d");a.clearRect(0,0,r,r);for(var l=a.createImageData(r,r),s=l.data,i=0;r>i;i++)for(var n=0;r>n;n++){e.setHsv(o,Math.round(100*i/(r-1)),Math.round(100*n/(r-1)));var c=4*((r-n-1)*r+i);s[c]=e.r(),s[c+1]=e.g(),s[c+2]=e.b(),s[c+3]=255}if(a.putImageData(l,0,0),!Y.directCanvasRotate){var h=B.toDataURL();L.square[0].src=h}}function y(t){var e=t===r?Q.hue():t,o=e/180*Math.PI,a=N.circleWidth,l=.025,s={transform:"rotate("+o+"rad)",left:a/2-a*Math.sin(-o+l)/2,top:a/2-a*Math.cos(-o+l)/2};L.circleMark.css(s),F=o-Math.PI/4,K={},A.behavior.rotate&&L.square.css({transform:"rotate("+F+"rad)"})}function H(t,e){var o=N.squareWidth,a=Q.toHsv(),l=0,s=0;if(t!==r&&(V=t),e!==r&&(X=e),V!==r&&X!==r?(l+=V,s+=X):(l+=~~(a.s*o/100),s+=o-~~(a.v*o/100),l=Math.max(0,Math.min(o-1,l)),s=Math.max(0,Math.min(o-1,s))),!K.rev){var i=N.squareWidth/2,n=N.elWidth/2;K.rev=new SmallColorPicker.Transforms.Translate2D(-i,-i),A.behavior.rotate&&K.rev.chain(new SmallColorPicker.Transforms.Rotate2D(F)),K.rev.chain(new SmallColorPicker.Transforms.Translate2D(n-3,n-3))}var c=K.rev.apply([l,s]),h=L.squareMark[0].style;h.left=c[0]+"px",h.top=c[1]+"px",q()}function q(){var t=Q.getPerceivedBrightness()>125;if(N.isSqMaskLight!==t){N.isSqMaskLight=t;var e=(new SmallColorPicker.Color).setHsv(0,0,t?40:90);L.squareMark[0].style.borderColor=e.toHex(),R(L.squareMark[0])}}function R(t){Y.redrawBug&&(t.style.display="inline-block",t.offsetHeight,t.style.display="block")}function I(){y(),H()}function W(){return L&&L.el&&L.el.is(":visible")}function O(){L.el.hide()}var L,N,B,V,X,Y,j,A=t.extend(!0,{},SmallColorPicker.defaults,a),Q=new SmallColorPicker.Color(A.colors.colorNew),U=new SmallColorPicker.Color(A.colors.colorOld),z=A.placement.parent?t(A.placement.parent):null,F=0,K={};this.toggle=function(){this.isVisible()?this.hide():this.show()},this.show=function(){L||l(),D(Q.toHex()),P(),x(),I(),L.el.show(),n(),p()},this.isVisible=W,this.hide=O,this.setColors=function(t,e){t!==r&&(Q=new SmallColorPicker.Color(t)),e!==r&&(U=null===e?null:new SmallColorPicker.Color(e)),this.isVisible()&&this.show()},this.parent=function(e){return e&&(this.isVisible()?(this.hide(),z=t(e),this.show()):z=t(e)),z}}})(window.jQuery,document,window),function(t,e,o,r){"use strict";o.SmallColorPicker=o.SmallColorPicker||{},SmallColorPicker.Color=function(t){if(this.val=0,"number"==typeof t)this.val=t;else if("string"==typeof t)if("#"===t.charAt(0))this.val=parseInt(t.substr(1),16);else{var e=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/g.exec(t);if(!e)throw"Invalid color: "+t;this.setRgb(parseInt(e[1]),parseInt(e[2]),parseInt(e[3]))}},SmallColorPicker.Color.prototype={constructor:SmallColorPicker.Color,r:function(t){return t!==r?(this.val=65535&this.val|t<<16,t):255&this.val>>16},g:function(t){return t!==r?(this.val=16711935&this.val|t<<8,t):255&this.val>>8},b:function(t){return t!==r?(this.val=16776960&this.val|t,t):255&this.val},toHex:function(){var t=("00000"+this.val.toString(16)).substr(-6);return"#"+t},toRgb:function(){return{r:this.r(),g:this.g(),b:this.b()}},toRgbStr:function(){return"rgb("+this.r()+","+this.g()+","+this.b()+")"},setRgb:function(t,e,o){return this.r(t),this.g(e),this.b(o),this},toHsv:function(){var t,e,o,r=this.r(),a=this.g(),l=this.b(),s=Math.min(r,a,l),i=Math.max(r,a,l),n=i-s;if(o=Math.floor(100*(i/255)),0==i)return{h:0,s:0,v:0};e=Math.floor(100*(n/i));var c=0==n?1:n;return t=r==i?(a-l)/c:a==i?2+(l-r)/c:4+(r-a)/c,t=Math.floor(60*t),0>t&&(t+=360),{h:t,s:e,v:o}},setHsv:function(t,e,o){if(t/=360,e/=100,o/=100,0==e){var r=Math.round(255*o);return this.r(r),this.g(r),this.b(r),this}var a,l,s,i=6*t,n=Math.floor(i),c=o*(1-e),h=o*(1-e*(i-n)),p=o*(1-e*(1-(i-n)));return 0==n?(a=o,l=p,s=c):1==n?(a=h,l=o,s=c):2==n?(a=c,l=o,s=p):3==n?(a=c,l=h,s=o):4==n?(a=p,l=c,s=o):(a=o,l=c,s=h),this.r(Math.round(255*a)),this.g(Math.round(255*l)),this.b(Math.round(255*s)),this},hue:function(t){if(t!==r){var e=this.toHsv();return this.setHsv(t,e.s,e.v),this}return this.toHsv().h},getPerceivedBrightness:function(){var t=this.toRgb();return Math.sqrt(.241*t.r*t.r+.691*t.g*t.g+.068*t.b*t.b)}}}(window.jQuery,document,window),function(t,e,o){"use strict";o.SmallColorPicker=o.SmallColorPicker||{},SmallColorPicker.Transforms={},SmallColorPicker.Transforms.Transform2D=function(t){this.matrix=t,this.next=null},SmallColorPicker.Transforms.Transform2D.prototype={constructor:SmallColorPicker.Transforms.Transform2D,apply:function(t){var e=[this.matrix[0][0]*t[0]+this.matrix[0][1]*t[1]+this.matrix[0][2],this.matrix[1][0]*t[0]+this.matrix[1][1]*t[1]+this.matrix[1][2]];return this.next?this.next.apply(e):e},chain:function(t){return this.next?this.next.chain(t):this.next=t,this}},SmallColorPicker.Transforms.Translate2D=function(t,e){SmallColorPicker.Transforms.Transform2D.call(this,[[1,0,t],[0,1,e]])},SmallColorPicker.Transforms.Translate2D.prototype=new SmallColorPicker.Transforms.Transform2D,SmallColorPicker.Transforms.Translate2D.prototype.constructor=SmallColorPicker.Transforms.Translate2D,SmallColorPicker.Transforms.Rotate2D=function(t){var e=Math.cos(t),o=Math.sin(t);SmallColorPicker.Transforms.Transform2D.call(this,[[e,-o,0],[o,e,0]])},SmallColorPicker.Transforms.Rotate2D.prototype=new SmallColorPicker.Transforms.Transform2D,SmallColorPicker.Transforms.Rotate2D.prototype.constructor=SmallColorPicker.Transforms.Translate2D}(window.jQuery,document,window);